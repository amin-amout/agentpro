{
  "SystemOverview": {
    "Title": "LocalNetChat",
    "Description": "A cross-platform, peer-to-peer desktop chat and file-sharing application that operates entirely on a local network without external servers. It discovers peers via UDP multicast, establishes TCP connections for text and file exchange, and optionally secures traffic with TLS.",
    "Scope": "Desktop clients (Windows 10+, macOS 10.13+, Ubuntu 18.04+). Optional mobile preview (Android/iOS).",
    "Stakeholders": [
      {
        "role": "End User",
        "description": "Employees, students, or home users who need quick local communication."
      },
      {
        "role": "IT Administrator",
        "description": "Manages network policies and ensures compliance."
      },
      {
        "role": "Developer",
        "description": "Builds and maintains the application."
      }
    ],
    "Assumptions": [
      "All clients are on the same subnet or can discover each other via multicast/broadcast.",
      "Users have permission to open required ports on local firewall.",
      "File sizes are limited to 100 MB per transfer to keep bandwidth usage reasonable."
    ],
    "Constraints": [
      "No internet or cloud services.",
      "Cross-platform compatibility with Java 17 (Swing) or Electron/Node.js.",
      "Security: encryption optional but recommended; no user authentication beyond local login."
    ],
    "SuccessCriteria": [
      {
        "id": "SC01",
        "description": "All user stories are implemented and pass automated unit and integration tests."
      },
      {
        "id": "SC02",
        "description": "The app is stable on all targeted platforms with no memory leaks (>512 MB RAM usage)."
      },
      {
        "id": "SC03",
        "description": "User acceptance test score >= 90 % on usability survey."
      },
      {
        "id": "SC04",
        "description": "Network traffic analysis shows minimal overhead: discovery packets < 1 kB, message packets < 512 B."
      }
    ]
  },
  "ComponentArchitecture": {
    "PresentationLayer": {
      "Description": "Swing/Electron UI, responsible for user interaction, status display, chat windows, file transfer dialogs, and keyboard shortcuts.",
      "Modules": [
        "MainWindow",
        "UserListPanel",
        "ChatWindow",
        "FileTransferPanel",
        "SettingsDialog"
      ]
    },
    "DiscoveryService": {
      "Description": "UDP multicast/broadcast component that sends and receives presence packets.",
      "Responsibilities": [
        "Broadcast presence every 5 s: JSON {type:'presence', id, name, status, port, ttl}",
        "Listen for incoming presence packets and maintain a live peer cache.",
        "Publish status updates every 10 s: JSON {type:'status', id, status}"
      ]
    },
    "PeerConnectionManager": {
      "Description": "Manages TCP sockets per peer, handles connection lifecycle, reconnection logic, and optional TLS.",
      "Responsibilities": [
        "Open outgoing TCP connection when user initiates chat/file transfer.",
        "Accept incoming TCP connections on advertised port.",
        "Maintain connection health and retry every 5 s if dropped.",
        "Log connection attempts (audit) without logging message content."
      ]
    },
    "MessageHandler": {
      "Description": "Encodes/decodes JSON message frames and routes them to the UI.",
      "Responsibilities": [
        "Send/receive {type:'msg', from, to, timestamp, content}",
        "Enforce in-memory session history only."
      ]
    },
    "FileTransferService": {
      "Description": "Handles file transfer protocol over a dedicated TCP stream.",
      "Responsibilities": [
        "Send header {type:'file', from, to, filename, size, checksum}",
        "Stream raw file bytes with optional pause/resume.",
        "Validate checksum on receipt.",
        "Reject files >100 MB and notify user."
      ]
    },
    "ConfigurationManager": {
      "Description": "Persist user settings in a local encrypted file (optional).",
      "Responsibilities": [
        "Store display name, status message, default download folder, TLS toggle."
      ]
    },
    "SecurityModule": {
      "Description": "Optional TLS wrapper for all TCP streams.",
      "Responsibilities": [
        "Generate self-signed certificates per instance.",
        "Provide encryption toggle in settings."
      ]
    },
    "LoggingService": {
      "Description": "Audit log of connection attempts and status changes.",
      "Responsibilities": [
        "Write to local file with timestamp, peer id, event type.",
        "Exclude message payloads."
      ]
    }
  },
  "DataModel": {
    "Peer": {
      "id": "UUID string",
      "name": "String",
      "status": "online|away|offline",
      "port": "Integer",
      "lastSeen": "ISO8601 timestamp"
    },
    "PresencePacket": {
      "type": "presence",
      "id": "String",
      "name": "String",
      "status": "String",
      "port": "Integer",
      "ttl": "Integer (seconds)"
    },
    "StatusPacket": {
      "type": "status",
      "id": "String",
      "status": "String"
    },
    "MessagePacket": {
      "type": "msg",
      "from": "String",
      "to": "String",
      "timestamp": "ISO8601",
      "content": "String"
    },
    "FileHeader": {
      "type": "file",
      "from": "String",
      "to": "String",
      "filename": "String",
      "size": "Integer",
      "checksum": "SHA-256 hex string"
    }
  },
  "APIDesign": {
    "DiscoveryAPI": {
      "broadcastPresence": {
        "method": "UDP",
        "interval": "5s",
        "payload": "PresencePacket"
      },
      "receivePresence": {
        "method": "UDP",
        "handler": "updatePeerCache(Peer)"
      }
    },
    "StatusAPI": {
      "broadcastStatus": {
        "method": "UDP",
        "interval": "10s",
        "payload": "StatusPacket"
      }
    },
    "PeerConnectionAPI": {
      "connectToPeer(peerId)": {
        "action": "TCP connect to advertised port",
        "tlsEnabled": "boolean"
      },
      "acceptConnection": {
        "action": "listen on local port",
        "protocol": "TCP"
      }
    },
    "MessageAPI": {
      "sendMessage(toId, content)": {
        "payload": "MessagePacket",
        "transport": "TCP"
      },
      "receiveMessage(handler)": {
        "transport": "TCP",
        "handler": "displayMessage(MessagePacket)"
      }
    },
    "FileTransferAPI": {
      "requestFile(toId, filePath)": {
        "payload": "FileHeader",
        "transport": "TCP",
        "postSend": "displayProgress"
      },
      "receiveFile(handler)": {
        "transport": "TCP",
        "handler": "writeFile(FileHeader, stream)"
      }
    }
  },
  "TechnologyStack": {
    "CoreLanguage": "Java 17 (Swing) or Node.js 20 (Electron)",
    "Networking": "Java NIO / Node.js net module",
    "Serialization": "Jackson (Java) or JSON5 (Node.js)",
    "TLS": "Java SSLContext / Node.js TLS module",
    "UI": "Swing (Java) or HTML/CSS/React (Electron)",
    "BuildTool": "Maven (Java) or npm/yarn (Electron)",
    "Testing": "JUnit 5 / TestFX (Java) or Jest + Spectron (Electron)",
    "Packaging": "jpackage (Java) or Electron Packager",
    "CrossPlatformSupport": "JavaFX/Native look-and-feel or Electron auto-update",
    "Logging": "SLF4J + Logback (Java) or Winston (Node.js)",
    "Configuration": "Properties file (Java) or JSON (Electron)",
    "Checksum": "SHA-256 (built-in libraries)"
  },
  "DeploymentArchitecture": {
    "Installation": {
      "Windows": "MSI or EXE built with jpackage / Electron Installer",
      "macOS": "DMG or PKG",
      "Linux": "AppImage / DEB / RPM"
    },
    "Execution": {
      "Auto-start": "Optional system tray icon; user can launch manually.",
      "Firewall": "Requests to open UDP multicast port 5000 and TCP port range 6000-6100.",
      "Privileges": "No admin rights required; uses standard user directories for downloads."
    },
    "UpdateStrategy": {
      "Desktop": "In-app self-update via local file or network-based update server (optional).",
      "MobilePreview": "APK/IPA built separately."
    },
    "ResourceConstraints": {
      "Memory": "<512 MB per instance",
      "CPU": "Single thread for UI, separate thread pool for networking (max 4 threads)."
    }
  }
}